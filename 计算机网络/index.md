## 七层模型

* 应用层
  * http
  * dns
* 传输层
  * tcp
  * udp
* 网络层
  * ip
  * arp
* 链路层
* 物理层

### DNS

* 作用：将域名转化为ip地址

* 实现基于UDP
* 域名服务器：
  * 本地域名服务器
  * 权限域名服务器
  * 顶级域名服务器
  * 根域名服务器哦
* 查询过程：
  1. 主机先向本地域名服务器进行递归查询
  2. 本地域名服务器采用迭代查询，向一个根域名服务器进行查询
  3. 根域名服务器告诉本地域名服务器，下一次应该查询的顶级域名服务器的IP地址
  4. 本地域名服务器向顶级域名服务器进行查询
  5. 顶级域名服务器告诉本地域名服务器，下一步查询权限服务器的IP地址
  6. 本地域名服务器向权限服务器进行查询
  7. 权限服务器告诉本地域名服务器所查询的主机的IP地址
  8. 本地域名服务器最后把查询结果告诉主机
* 递归查询和迭代查询：
  * 递归查询：将查询委托给一个服务器，由委托服务器返回最终结果
  * 迭代查询：服务器只返回自己能返回的结果，主机接收到可能是查询的中间结果。

### TCP

* 三次握手：
  1. 客户端->服务器：syn=1，seq=x
  2. 服务器->客户端：syn=1，seq=y，ack=x+1
  3. 客户端->服务器：ack=y+1
* 保证可靠性：
  * 校验和：奇偶校验
  * seq和ack：seq=x，ack=x+1
  * 超时重传：
    * 接收方会对每个接收到的包发送ack，如果在规定时间内发送方没有受到ack应答，则重传数据。
  * 流量控制
    * 滑动窗口：接收方会在应答报文中填入自己能接受的窗口大小，发送方会按照此窗口调整自己的发送速度。
  * 拥塞控制
    * 慢启动：
      * 指数增长：在拥塞窗口阈值之前发送速度指数增长。
      * 拥塞避免：在拥塞窗口阈值之后发送速度线性增长。
      * 拥塞发生：在拥塞发生后，将拥塞窗口阈值设为当前发送速度的一半，并执行指数增长阶段（快速回复）

### http

* http版本：
  * 1.0：基准
  * 1.1：缓存管理、持节链接、断点续传
  * 2.0：pipeline、二进制分帧
* https：
  1. 客户端生成一个随机数，并发送https链接请求
  2. 服务器生成一个随机数，并将随机数和公钥证书发回客户端
  3. 客户端生成一个随机数，并用三个随机数合成一个对话密钥，用公钥加密这个对话密钥，发回服务器
  4. 服务器用私钥解密对话密钥，之后的通信使用对话密钥加密通信
* content-type：
  * text/html ： HTML格式
  * text/plain ：纯文本格式
  * application/json： JSON数据格式
  * application/x-www-form-urlencoded：表单数据
  * multipart/form-data： 需要在表单中进行文件上传时，就需要使用该格式
* http状态码：
  * 100    Continue    继续。客户端应继续其请求
  * 200    OK    请求成功。一般用于GET与POST请求
  * 202    Accepted    已接受。已经接受请求，但未处理完成
  * 204    No Content    无内容。服务器成功处理，但未返回内容。在未更新网页的情况下，可确保浏览器继续显示当前文档
  * 301    Moved Permanently    永久移动。请求的资源已被永久的移动到新URI，返回信息会包括新的URI，浏览器会自动定向到新URI。今后任何新的请求都应使用新的URI代替
  * 304    Not Modified    未修改。所请求的资源未修改，服务器返回此状态码时，不会返回任何资源。客户端通常会缓存访问过的资源，通过提供一个头信息指出客户端希望只返回在指定日期之后修改的资源
  * 401    Unauthorized    请求要求用户的身份认证
  * 404    Not Found    服务器无法根据客户端的请求找到资源（网页）。通过此代码，网站设计人员可设置"您所请求的资源无法找到"的个性页面
  * 500    Internal Server Error    服务器内部错误，无法完成请求

